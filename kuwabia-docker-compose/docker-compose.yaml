
# using fixed ip addresses
# to see all network use docker network ls
# to see config use docker network inspect kuwabia-docker-compose_kuwaiba-net
# note gateway is 172.30.0.1 
networks:
  kuwaiba-net:
    ipam:
      config:
        - subnet: 172.30.0.0/24

volumes:
  data-kuwaiba: {}

services:
  kuwaiba:
 #    image: ${DOCKER_REGISTRY:-docker.io}/neotropic/kuwaiba:${KUWAIBA_VERSION:-v2.1-nightly}
    image: onms-integration/kuwaiba
    build: ./container-fs/kuwaiba/
    container_name: kuwaiba
    hostname: kuwaiba
 #   environment:
 #    URL_DATA: https://sourceforge.net/projects/kuwaiba/files/Version%202.x/kuwaiba_server_2.1.1_stable.zip
    volumes:
      - data-kuwaiba:/data
      - ./container-fs/kuwaiba/start.sh:/start.sh
      - ./container-fs/kuwaiba/data:/data-overlay
    ports:
      - "8080:8080"
      - "8081:8081"

    # To combine stderr and stdout into the stdout stream, we append this to a command: 2>&1
    # command: sh -c "java -jar /opt/programs/kuwaiba_server_2.1.1-stable.jar > /data/logs/kuwaiba_$(date +%Y%m%d_%H%M%S).log 2>&1"
    command: sh /start.sh

    networks:
      kuwaiba-net:
        ipv4_address: 172.30.0.55
